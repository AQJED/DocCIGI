<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A Comprehensive Guide to Converting DIS to CIGI</title>
  <style>
    /* Base Resets */
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f6f2ea;
      color: #2e2a20;
    }
    /* Sidebar Styling */
    .sidebar {
      background-color: #efe6d7;
      width: 250px;
      padding: 20px;
      position: fixed;
      height: 100%;
      overflow-y: auto;
      box-sizing: border-box;
      border-right: 1px solid #d8cbb3;
    }
    .sidebar .brand {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .sidebar .version {
      font-size: 0.75rem;
      color: #6a5f4d;
    }
    .search-box {
      width: 100%;
      padding: 8px;
      margin-bottom: 20px;
      border: 1px solid #d8cbb3;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .nav-links a {
      display: block;
      color: #2e2a20;
      text-decoration: none;
      padding: 8px 0;
      border-bottom: 1px solid #d8cbb3;
    }
    .nav-links a:hover {
      background-color: #eadfc9;
    }
    /* Main Content Styling */
    .content {
      margin-left: 270px; /* Sidebar width plus margin */
      padding: 20px;
      max-width: 900px;
      box-sizing: border-box;
    }
    .breadcrumb {
      font-size: 0.875rem;
      margin-bottom: 10px;
      color: #6a5f4d;
    }
    .page-title {
      font-size: 2rem;
      margin-bottom: 10px;
      font-weight: bold;
    }
    .lead {
      font-size: 1.125rem;
      margin-bottom: 20px;
      color: #6a5f4d;
    }
    .doc-section {
      margin-bottom: 40px;
    }
    .doc-section h2 {
      font-size: 1.75rem;
      margin-bottom: 10px;
      border-bottom: 2px solid #d8cbb3;
      padding-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .doc-section h3 {
      font-size: 1.5rem;
      margin-top: 20px;
      margin-bottom: 10px;
    }
    .doc-section h4 {
      font-size: 1.25rem;
      margin-top: 15px;
      margin-bottom: 10px;
      color: #2e2a20; /* Match body text color */
    }
    /* Table Styling */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #d8cbb3;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #eadfc9;
      font-weight: bold;
    }
    tr:nth-child(even) {
      background-color: #f2ebdd;
    }
    /* Code Block Styling */
    pre {
      background-color: #2b2d42;
      color: #f8f8f2;
      padding: 10px;
      overflow-x: auto;
      border-radius: 4px;
    }
    /* Footer Styling */
    .footer {
      text-align: center;
      font-size: 0.875rem;
      color: #6a5f4d;
      margin-top: 40px;
      padding: 20px;
      border-top: 1px solid #d8cbb3;
    }
    /* Responsive Adjustments */
    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        position: relative;
        height: auto;
        border-right: none;
      }
      .content {
        margin-left: 0;
      }
    }
    /* Style for image figures */
    .image-banner figure {
      display: inline-block;
      margin-right: 10px;
      text-align: center;
    }
    .image-banner figure:last-child {
      margin-right: 0;
    }
    .image-banner img {
      max-width: 100%;
      height: auto;
    }
    .image-banner figcaption {
      font-size: 0.875rem;
      color: #6a5f4d;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <h1 class="brand">DIS-CIGI <span class="version">v1.1</span></h1>
    <input type="text" placeholder="Search articles..." class="search-box" />
    <nav class="nav-links">
      <a href="#introduction">Getting Started</a>
      <a href="#dis-protocol">DIS Protocol</a>
      <a href="#cigi-protocol">CIGI Protocol</a>
      <a href="#mapping">Mapping Strategy</a>
      <a href="#conversion">Conversion Flow</a>
      <a href="#best-practices">Best Practices</a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="content">
    <div class="breadcrumb">Home</div>
    <h1 class="page-title" id="introduction">Getting Started</h1>
    <p class="lead">
      This guide focuses on converting DIS Entity State PDU data into CIGI-compliant packets. It concentrates on the practical conversion process (mapping strategies, data conversion, and update rate) so you can achieve reliable interoperability between DIS-based sources and CIGI-driven image generators.
    </p>

    <h3>Main Difference</h3>
    <ul>
      <li><strong>DIS</strong> is a network exchange format for simulation state across participants. It describes <em>what exists</em> and <em>how it moves</em>.</li>
      <li><strong>CIGI</strong> is a visual control protocol for IGs. It tells the IG <em>what to draw</em> and <em>how to draw it</em>, frame by frame.</li>
    </ul>

    <!-- DIS Protocol Section -->
    <section class="doc-section" id="dis-protocol">
      <h2>Understanding the DIS Protocol</h2>
      <p>
        DIS (Distributed Interactive Simulation) is used for exchanging simulation data such as entity states, movements, and interactions across distributed systems. The Entity State PDU encapsulates detailed information about each simulation entity.
      </p>
      <p><em>Key idea:</em> DIS gives you <strong>truth snapshots</strong> at its own update rate. You will translate these into IG-friendly pose updates and states.</p>

      <!-- Insert the single DIS image with caption -->
      <div class="image-banner">
        <figure>
          <img src="DIS.png" alt="A DIS Package Sample Capture by Wireshark.">
          <figcaption style="font-size: 1.2em; font-weight: bold;">A DIS Package Sample Capture by Wireshark.</figcaption>
        </figure>
      </div>

      <h3>DIS Packet Structure: Detailed Field Breakdown</h3>
      <table>
         <thead>
           <tr>
             <th>Field Name</th>
             <th>Description</th>
             <th>OpenDIS Getter Function</th>
           </tr>
         </thead>
         <tbody>
           <tr>
             <td>Protocol Version</td>
             <td>Version of the DIS protocol used.</td>
             <td>getProtocolVersion()</td>
           </tr>
           <tr>
             <td>PDU Type</td>
             <td>Identifies the type of PDU (e.g., Entity State).</td>
             <td>getPduType()</td>
           </tr>
           <tr>
             <td>PDU Length</td>
             <td>Total length of the PDU in bytes.</td>
             <td>getLength()</td>
           </tr>
           <tr>
             <td>Timestamp</td>
             <td>Relative time of packet capture.</td>
             <td>getTimestamp()</td>
           </tr>
           <tr>
             <td>Entity ID (Composite)</td>
             <td>Site ID, Application ID, Entity ID.</td>
             <td>getEntityID()</td>
           </tr>
           <tr>
             <td>Force ID</td>
             <td>Affiliation (e.g., friendly, enemy).</td>
             <td>getForceId()</td>
           </tr>
           <tr>
             <td>Entity Type</td>
             <td>Country, domain, category, etc.</td>
             <td>getEntityType()</td>
           </tr>
           <tr>
             <td>Entity Appearance</td>
             <td>32-bit bitfield (visual flags, health, state).</td>
             <td>getEntityAppearance()</td>
           </tr>
           <tr>
             <td>Entity Location (X, Y, Z)</td>
             <td>ECEF coordinates.</td>
             <td>getEntityLocation()</td>
           </tr>
           <tr>
             <td>Entity Orientation</td>
             <td>Euler angles (Psi, Theta, Phi) in radians.</td>
             <td>getEntityOrientation()</td>
           </tr>
           <tr>
             <td>Linear Velocity (X, Y, Z)</td>
             <td>Velocity in m/s.</td>
             <td>getEntityLinearVelocity()</td>
           </tr>
           <tr>
             <td>Dead Reckoning Params</td>
             <td>Extrapolation parameters.</td>
             <td>getDeadReckoningParameters()</td>
           </tr>
           <tr>
             <td>Marking</td>
             <td>ASCII up to 11 chars.</td>
             <td>getMarking()</td>
           </tr>
           <tr>
             <td>Capabilities</td>
             <td>Entity capability bitmask.</td>
             <td>getCapabilities()</td>
           </tr>
         </tbody>
      </table>
    </section>

    <!-- CIGI Protocol Section -->
    <section class="doc-section" id="cigi-protocol">
      <h2>Exploring the CIGI Protocol</h2>
      <p>
        CIGI (Common Image Generator Interface) sends real-time control data to image generators, ensuring rendered visuals reflect the simulation state. It operates on a frame-based update system.
      </p>
      <p><em>Key idea:</em> CIGI does <strong>not</strong> carry explicit velocity fields for entities. Motion is perceived through successive pose updates at an adequate frequency.</p>

      <figure>
        <img src="CIGI.png" alt="A CIGI Package Sample Capture by Wireshark.">
        <figcaption style="font-size: 1.2em; font-weight: bold;">A CIGI Package Sample Capture by Wireshark.</figcaption>
      </figure>

      <h3>CIGI Packet Structure: Detailed Field Breakdown</h3>
      <table>
         <thead>
           <tr>
             <th>Field Name</th>
             <th>Description</th>
             <th>CCL Setter Function</th>
           </tr>
         </thead>
         <tbody>
           <tr><td>Packet ID</td><td>Packet type (e.g., Entity Control).</td><td>—</td></tr>
           <tr><td>Packet Size</td><td>Total size.</td><td>—</td></tr>
           <tr><td>Entity ID</td><td>Unique 16-bit per session.</td><td>SetEntityID()</td></tr>
           <tr><td>Entity State</td><td>Lifecycle/activity.</td><td>SetEntityState()</td></tr>
           <tr><td>Attach State</td><td>Attached/Detached.</td><td>SetAttachState()</td></tr>
           <tr><td>Collision Detection</td><td>Collision flags.</td><td>SetCollisionDetectEn()</td></tr>
           <tr><td>Inherit Alpha</td><td>Alpha inheritance.</td><td>SetInheritAlpha()</td></tr>
           <tr><td>Ground/Ocean Clamp</td><td>Clamp mode.</td><td>SetGrndClamp()</td></tr>
           <tr><td>Alpha</td><td>Transparency.</td><td>SetAlpha()</td></tr>
           <tr><td>Entity Type</td><td>IG model/type.</td><td>SetEntityType()</td></tr>
           <tr><td>Parent ID</td><td>Parent entity.</td><td>SetParentID()</td></tr>
           <tr><td>Roll</td><td>Degrees.</td><td>SetRoll()</td></tr>
           <tr><td>Pitch</td><td>Degrees.</td><td>SetPitch()</td></tr>
           <tr><td>Yaw</td><td>Degrees.</td><td>SetYaw()</td></tr>
           <tr><td>Latitude</td><td>Degrees.</td><td>SetLat()</td></tr>
           <tr><td>Longitude</td><td>Degrees.</td><td>SetLon()</td></tr>
           <tr><td>Altitude</td><td>Meters.</td><td>SetAlt()</td></tr>
         </tbody>
      </table>
    </section>

    <!-- Mapping Strategy Section -->
    <section class="doc-section" id="mapping">
      <h2>Mapping DIS to CIGI: Step-by-Step Conversion Process</h2>
      <p>
        Mapping a DIS packet to a CIGI packet requires careful handling of field definitions, data representations, and protocol design differences. The process is broken down into several key steps:
      </p>

      

      <h3>Challenges in Field Mapping</h3>
      <ul>
        <li>
          <strong>Composite vs. Simple Identifiers (Entity ID)</strong><br />
          DIS uses a composite 6-byte identifier (Site, App, Entity). CIGI typically uses a single 16-bit ID unique only within a session.
          <br /><br />
          <table>
            <thead><tr><th>Protocol</th><th>Field Breakdown</th><th>Value</th></tr></thead>
            <tbody>
              <tr><td>DIS</td><td>Site ID (uint16_t)</td><td>85</td></tr>
              <tr><td>DIS</td><td>App ID (uint16_t)</td><td>60</td></tr>
              <tr><td>DIS</td><td>Entity ID (uint16_t)</td><td>1001</td></tr>
              <tr><td>→ Composite ID</td><td colspan="2">(85, 60, 1001)</td></tr>
              <tr><td>CIGI</td><td>Entity ID (16-bit)</td><td>1 (mapped)</td></tr>
            </tbody>
          </table>
          Example: map DIS (85, 60, 1001) → CIGI 1.
        </li>

        <li>
          <strong>Composite vs. Simple Entity Type Identifiers (Entity Type)</strong><br />
          DIS uses a detailed 7-field composite type; CIGI uses a single 16-bit type per IG database/modeling scheme.
          <br /><br />
          <table>
            <thead><tr><th>Protocol</th><th>Field Breakdown</th><th>Value</th></tr></thead>
            <tbody>
              <tr><td>DIS</td><td>Entity Kind (u8)</td><td>1</td></tr>
              <tr><td>DIS</td><td>Domain (u8)</td><td>1</td></tr>
              <tr><td>DIS</td><td>Country (u16)</td><td>225</td></tr>
              <tr><td>DIS</td><td>Category (u8)</td><td>2</td></tr>
              <tr><td>DIS</td><td>Subcategory (u8)</td><td>1</td></tr>
              <tr><td>DIS</td><td>Specific (u8)</td><td>0</td></tr>
              <tr><td>DIS</td><td>Extra (u8)</td><td>0</td></tr>
              <tr><td>→ Composite</td><td colspan="2">(1,1,225,2,1,0,0)</td></tr>
              <tr><td>CIGI</td><td>Entity Type (16-bit)</td><td>101 (mapped)</td></tr>
            </tbody>
          </table>
          Example: map DIS composite type → CIGI type 101.
        </li>

        <li><strong>Coordinate Conversion:</strong> Convert ECEF coordinates (DIS) into geodetic coordinates (latitude, longitude, altitude) for CIGI.</li>
	  <li><strong>Orientation Conversion:</strong> Convert DIS::EulerAngles psi, phi, theta (ECEF) to NED Euler angles roll, pitch, yaw using a manual transformation matrix, not just converting radians to degrees, and adjust for left-handed NED if required by the Image Generator.</li>
      </ul>

       <h3>Use of Lookup Tables (Alternative Strategy)</h3>
      <p>
        In many real-world simulation environments, an alternative and often more efficient approach is to use explicit lookup tables to map DIS fields to predefined CIGI values. This is particularly helpful when the simulation environment is known in advance.
      </p>
      <ul>
        <li><strong>Example Use Cases:</strong> Mapping DIS entity types or appearance flags to corresponding CIGI database IDs, model types, or animation settings.</li>
        <li><strong>Advantages:</strong> Improves runtime efficiency, simplifies mapping logic, and provides deterministic behavior for entity rendering.</li>
        <li><strong>Use Case Dependency:</strong> In tightly controlled simulation systems (e.g., military aircraft or ground vehicles), this approach is not only easier but sometimes the only practical way to ensure correct CIGI behavior.</li>
      </ul>

      <h3>Entity Lifecycle Management</h3>
      <p>
        One key difference between the two protocols lies in entity lifecycle control. DIS broadcasts entity state continuously—meaning an entity “exists” as long as its state is being transmitted. In contrast, CIGI requires explicit management of entity states:
      </p>
      </p>
      <ul>
        <li><strong>Spawn:</strong> On first sighting, send Entity Control with <code>Active</code>.</li>
        <li><strong>Update:</strong> Continue sending <code>Active</code> with pose updates.</li>
        <li><strong>Remove:</strong> When DIS stops or entity is gone, send <code>Remove</code> to clear visuals.</li>
      </ul>
    </section>

    <!-- Conversion Flow Section -->
    <section class="doc-section" id="conversion">
      <h2>Detailed Data Conversion and Velocity Handling</h2>
      <p>
        Data conversion transforms DIS fields into CIGI-ready values and handles motion via pose update rate rather than explicit velocity fields.
      </p>

      <h3>Consolidated Data Conversion Flow</h3>
      <ol>
        <li><strong>Extract:</strong> Use OpenDIS getters to read fields.</li>
        <li><strong>Identifiers:</strong> Map composite DIS IDs to session-unique CIGI IDs.</li>
        <li><strong>Orientation:</strong> Convert DIS ψ/θ/φ (radians) → degrees; normalize yaw/pitch/roll to your IG’s conventions.</li>
        <li><strong>Coordinates:</strong> Convert ECEF → WGS-84 (Lat/Lon/Alt) and validate ranges.</li>
        <li><strong>Appearance:</strong> Decode bitfields to CIGI states.</li>
        <li><strong>Assemble:</strong> Populate CIGI packets via CCL setters and send.</li>
      </ol>

      <h3>Velocity Handling</h3>
      <ul>
        <li><strong>Update rate over velocity:</strong> Since CIGI motion is inferred from successive poses, choose an update rate that hides sparse DIS input.</li>
        <li><strong>Interpolation / Dead-reckoning:</strong> If DIS rates are low/bursty, consider bounded, reversible smoothing so the pose converges back to truth on fresh DIS.</li>
        <li><strong>Determinism:</strong> Keep interpolation logic deterministic and logged for traceability.</li>
      </ul>

      <h4>Debugging and Reverse Engineering Notes</h4>
      <p>
        To accurately map between protocols, reverse engineering played a vital role. Using Wireshark, CIGI packets were captured during known events, such as spawning or firing. This allowed observation of:
      </p>
      <ul>
        <li>How CIGI represents multiple entities in one packet (e.g., aircraft and its fired munitions).</li>
        <li>Which specific setter values in the CIGI Class Library (CCL) are triggered in response to these events.</li>
      </ul>
      <p>
        From this, the mapping strategy was refined by referencing the CIGI Class Library (CCL) and OpenDIS side-by-side. DIS getters were used to extract data fields, and CIGI setters were then applied to build structured Entity Control packets.
      </p>
      <p>
        This reverse engineering approach filled in documentation gaps and confirmed expected behaviors on the Image Generator.
      </p>
    </section>

    <!-- Best Practices Section -->
    <section class="doc-section" id="best-practices">
      <h2>Conclusion and Best Practices</h2>
      <p>
        DIS→CIGI conversion hinges on steady IDs, robust coordinate/orientation transforms, and an update rate that visually conveys motion. Document and version your mapping decisions.
      </p>
      <h3>Best Practices</h3>
      <ul>
        <li>Document each conversion step with the exact getters/setters used.</li>
        <li>Validate data ranges (especially lat/lon and angle wraps).</li>
        <li>Persist lookup tables (ID/type/appearance) in version control.</li>
        <li>Log conversions and decisions for reproducibility.</li>
        <li>Prefer deterministic, bounded interpolation when smoothing sparse DIS input.</li>
      </ul>
    </section>

    <footer class="footer">
      <p>© 2025 Adeeb Alqahtani. All rights reserved.</p>
    </footer>
  </main>
</body>
</html>
